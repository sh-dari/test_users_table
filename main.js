(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(t,n){for(var r=0;r<n.length;r++){var o=n[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(void 0,i=function(t,n){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===e(i)?i:String(i)),o)}var i}var n=function(){function e(t){var n=t.baseUrl,r=t.headers;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.baseUrl=n,this.headers=r}var n,r;return n=e,(r=[{key:"getFetchAnswer",value:function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}},{key:"getInitialUsers",value:function(){var e=this;return fetch(this.baseUrl,{headers:this.headers}).then((function(t){return e.getFetchAnswer(t)}))}}])&&t(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),e}();function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===r(i)?i:String(i)),o)}var i}var i=function(){function e(t,n){var r=t.data,o=t.handleDeleteClick;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=r.username,this._email=r.email,this._date=r.registration_date,this._rating=r.rating,this._id=r.id,this._handleDeleteClick=o,this._templateSelector=n}var t,n;return t=e,(n=[{key:"_getTemplate",value:function(){return document.querySelector(this._templateSelector).content.querySelector(".elements__item").cloneNode(!0)}},{key:"_setEventListeners",value:function(){this._buttonDelete=this._element.querySelector(".elements__cancel"),this._buttonDelete.addEventListener("click",this._handleDeleteClick.bind(this))}},{key:"deleteUser",value:function(){this._element.remove()}},{key:"getId",value:function(){return this._id}},{key:"generateUser",value:function(){this._element=this._getTemplate();var e=this._date.split(/\-|\T/),t="".concat(e[0],".").concat(e[1],".").concat(e[2]);return this._element.querySelector(".elements__username").textContent=this._name,this._element.querySelector(".elements__email").textContent=this._email,this._element.querySelector(".elements__date").textContent=t,this._element.querySelector(".elements__rating").textContent=this._rating,this._setEventListeners(),this._element}}])&&o(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==a(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===a(o)?o:String(o)),r)}var o}var l=function(){function e(t,n){var r=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._renderer=r,this._container=document.querySelector(n)}var t,n;return t=e,(n=[{key:"addItem",value:function(e){this._container.append(e)}},{key:"addItemEnd",value:function(e){this._container.prepend(e)}},{key:"renderItems",value:function(e){var t=this;e.forEach((function(e){t._renderer(e)}))}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===c(o)?o:String(o)),r)}var o}var f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popup=document.querySelector(t),this._handleCloseEscPopup=this._handleCloseEscPopup.bind(this._popup),this._form=this._popup.querySelector(".popup__container"),this._closeButton=this._popup.querySelector(".popup__button_close")}var t,n;return t=e,(n=[{key:"_handleCloseEscPopup",value:function(e){"Escape"===e.key&&this.classList.remove("popup_opened")}},{key:"changeHandleFormSubmit",value:function(e){this._handleFormSubmit=e}},{key:"open",value:function(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleCloseEscPopup)}},{key:"close",value:function(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleCloseEscPopup)}},{key:"setEventListeners",value:function(){var e=this;this._popup.addEventListener("mousedown",(function(t){(t.target.classList.contains("popup_opened")||t.target.classList.contains("popup__close"))&&e.close()})),this._form.addEventListener("submit",(function(t){t.preventDefault(),e._handleFormSubmit()})),this._closeButton.addEventListener("mousedown",(function(t){e.close()}))}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function p(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=document.querySelector(".search__clean"),d=document.querySelector(".search__input"),v=document.querySelector(".filter__button_registration"),_=document.querySelector(".filter__button_rating"),b=new f(".popup"),h=new n({baseUrl:"https://5ebbb8e5f2cfeb001697d05c.mockapi.io/users",headers:{"Content-Type":"application/json"}}),S=new l({renderer:function(e){S.addItem(g(e))}},".elements__list"),g=function(e){var t=new i({data:e,handleDeleteClick:function(){b.changeHandleFormSubmit((function(){t.deleteUser(),b.close()})),b.open()}},"#item-template");return t.generateUser()};h.getInitialUsers().then((function(e){S.renderItems(e)})).catch((function(e){console.log(e)}));var w=function(){for(var e=d.value.toLowerCase(),t=document.querySelector(".elements__list").querySelectorAll(".elements__item_search"),n=0;n<t.length;n++)t[n].innerHTML.toLowerCase().indexOf(e)>-1?t[n].style.display="":t[n].style.display="none"};document.addEventListener("keyup",w),y.addEventListener("mouseup",(function(){d.value="",w()}));var k=function(e,t){var n=Number(e.querySelector(".elements__rating").textContent),r=Number(t.querySelector(".elements__rating").textContent);return _.classList.contains("filter__button_active")?n>=r?1:-1:n<=r?1:-1},E=function(e,t){var n=e.querySelector(".elements__date").textContent,r=t.querySelector(".elements__date").textContent;return v.classList.contains("filter__button_active")?n>=r?1:-1:n<=r?1:-1},L=function(e,t,n){n.classList.remove("filter__button_active");var r=document.querySelectorAll(".elements__item_search"),o=document.querySelector(".elements__list"),i=p(r).sort((function(e,n){return t(e,n)}));o.append.apply(o,p(i)),e.classList.toggle("filter__button_active")};v.addEventListener("click",(function(e){L(e.target,E,_)})),_.addEventListener("click",(function(e){L(e.target,k,v)})),b.setEventListeners()})();